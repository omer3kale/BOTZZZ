<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📊 Advanced Business Intelligence Suite</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .dashboard-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .dashboard-header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .dashboard-nav {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover, .nav-btn.active {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-2px);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #2d3748;
        }

        .card-icon {
            font-size: 1.5em;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .kpi-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255,255,255,0.1);
            transform: rotate(45deg);
            transition: all 0.3s ease;
        }

        .kpi-card:hover::before {
            transform: rotate(45deg) translate(50px, 50px);
        }

        .kpi-value {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 5px;
            position: relative;
            z-index: 1;
        }

        .kpi-label {
            font-size: 0.9em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .kpi-change {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            z-index: 1;
        }

        .kpi-change.positive {
            background: rgba(72, 187, 120, 0.8);
        }

        .kpi-change.negative {
            background: rgba(245, 101, 101, 0.8);
        }

        .kpi-change.neutral {
            background: rgba(160, 174, 192, 0.8);
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 15px;
        }

        .chart-container.large {
            height: 400px;
        }

        .insights-container {
            margin-top: 20px;
        }

        .insight-item {
            background: linear-gradient(90deg, #e3f2fd 0%, #f3e5f5 100%);
            margin: 10px 0;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #2196f3;
            position: relative;
        }

        .insight-badge {
            position: absolute;
            top: 5px;
            right: 10px;
            background: #2196f3;
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .recommendations-container {
            margin-top: 20px;
        }

        .recommendation-item {
            background: linear-gradient(90deg, #fff3e0 0%, #e8f5e8 100%);
            margin: 10px 0;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #ff9800;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recommendation-priority {
            background: #ff9800;
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
        }

        .recommendation-priority.high {
            background: #f44336;
        }

        .recommendation-priority.medium {
            background: #ff9800;
        }

        .recommendation-priority.low {
            background: #4caf50;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50 0%, #81c784 100%);
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .metric-trend {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }

        .trend-arrow {
            font-size: 1.2em;
            font-weight: bold;
        }

        .trend-up {
            color: #4caf50;
        }

        .trend-down {
            color: #f44336;
        }

        .trend-stable {
            color: #ff9800;
        }

        .export-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .export-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .realtime-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
        }

        .pulse {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .dashboard-container {
                padding: 10px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-btn {
                padding: 8px 16px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <!-- Real-time Indicator -->
    <div class="realtime-indicator">
        <div class="pulse"></div>
        <span>Live Data</span>
    </div>

    <div class="dashboard-container">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <h1>📊 Advanced Business Intelligence Suite</h1>
            <p>Comprehensive Business Analytics & Strategic Insights</p>
        </div>

        <!-- Navigation -->
        <div class="dashboard-nav">
            <button class="nav-btn active" onclick="showDashboard('executive')">Executive Dashboard</button>
            <button class="nav-btn" onclick="showDashboard('kpi')">KPI Monitoring</button>
            <button class="nav-btn" onclick="showDashboard('reports')">Business Reports</button>
            <button class="nav-btn" onclick="showDashboard('analytics')">Advanced Analytics</button>
            <button class="nav-btn" onclick="showDashboard('forecasting')">Forecasting</button>
        </div>

        <!-- Export Controls -->
        <div class="export-controls">
            <button class="export-btn" onclick="exportData('pdf')">📄 Export PDF</button>
            <button class="export-btn" onclick="exportData('excel')">📊 Export Excel</button>
            <button class="export-btn" onclick="exportData('csv')">📋 Export CSV</button>
            <button class="export-btn" onclick="refreshData()">🔄 Refresh Data</button>
        </div>

        <!-- Executive Dashboard -->
        <div id="executive-dashboard" class="dashboard-view">
            <div class="dashboard-grid">
                <!-- Executive KPIs -->
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Executive KPIs</h3>
                        <span class="card-icon">📈</span>
                    </div>
                    <div id="executive-kpis">
                        <div class="loading">
                            <div class="loading-spinner"></div>
                            <p>Loading executive metrics...</p>
                        </div>
                    </div>
                </div>

                <!-- Revenue Analytics -->
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Revenue Analytics</h3>
                        <span class="card-icon">💰</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>

                <!-- Customer Growth -->
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Customer Growth</h3>
                        <span class="card-icon">👥</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="customerChart"></canvas>
                    </div>
                </div>

                <!-- Performance Overview -->
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Performance Overview</h3>
                        <span class="card-icon">⚡</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Strategic Insights -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">Strategic Insights</h3>
                    <span class="card-icon">🎯</span>
                </div>
                <div id="strategic-insights">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>Generating strategic insights...</p>
                    </div>
                </div>
            </div>

            <!-- Business Recommendations -->
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">Strategic Recommendations</h3>
                    <span class="card-icon">💡</span>
                </div>
                <div id="business-recommendations">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>Analyzing business opportunities...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- KPI Dashboard -->
        <div id="kpi-dashboard" class="dashboard-view" style="display:none;">
            <div class="dashboard-card">
                <div class="card-header">
                    <h3 class="card-title">Key Performance Indicators</h3>
                    <span class="card-icon">🎯</span>
                </div>
                <div id="kpi-metrics">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>Loading KPI metrics...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Dashboard -->
        <div id="reports-dashboard" class="dashboard-view" style="display:none;">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Executive Summary Report</h3>
                        <span class="card-icon">📊</span>
                    </div>
                    <div id="executive-report">
                        <div class="loading">
                            <div class="loading-spinner"></div>
                            <p>Generating executive summary...</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Revenue Analysis Report</h3>
                        <span class="card-icon">💰</span>
                    </div>
                    <div id="revenue-report">
                        <div class="loading">
                            <div class="loading-spinner"></div>
                            <p>Analyzing revenue data...</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Customer Insights Report</h3>
                        <span class="card-icon">👥</span>
                    </div>
                    <div id="customer-report">
                        <div class="loading">
                            <div class="loading-spinner"></div>
                            <p>Processing customer insights...</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Campaign Performance Report</h3>
                        <span class="card-icon">🚀</span>
                    </div>
                    <div id="campaign-report">
                        <div class="loading">
                            <div class="loading-spinner"></div>
                            <p>Evaluating campaign performance...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Dashboard -->
        <div id="analytics-dashboard" class="dashboard-view" style="display:none;">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Advanced Analytics</h3>
                        <span class="card-icon">🔍</span>
                    </div>
                    <div class="chart-container large">
                        <canvas id="advancedChart"></canvas>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Conversion Funnel</h3>
                        <span class="card-icon">🎯</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="funnelChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Forecasting Dashboard -->
        <div id="forecasting-dashboard" class="dashboard-view" style="display:none;">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Revenue Forecasting</h3>
                        <span class="card-icon">🔮</span>
                    </div>
                    <div class="chart-container large">
                        <canvas id="forecastChart"></canvas>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <h3 class="card-title">Predictive Insights</h3>
                        <span class="card-icon">🎪</span>
                    </div>
                    <div id="predictive-insights">
                        <div class="loading">
                            <div class="loading-spinner"></div>
                            <p>Generating predictive insights...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentDashboard = 'executive';
        let dashboardData = {};
        let charts = {};

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadDashboardData();
            setInterval(refreshRealTimeData, 30000); // Refresh every 30 seconds
        });

        // Dashboard navigation
        function showDashboard(dashboardType) {
            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Hide all dashboard views
            document.querySelectorAll('.dashboard-view').forEach(view => {
                view.style.display = 'none';
            });

            // Show selected dashboard
            document.getElementById(`${dashboardType}-dashboard`).style.display = 'block';
            currentDashboard = dashboardType;

            // Load specific dashboard data
            switch(dashboardType) {
                case 'executive':
                    loadExecutiveDashboard();
                    break;
                case 'kpi':
                    loadKPIDashboard();
                    break;
                case 'reports':
                    loadReportsDashboard();
                    break;
                case 'analytics':
                    loadAnalyticsDashboard();
                    break;
                case 'forecasting':
                    loadForecastingDashboard();
                    break;
            }
        }

        // Load dashboard data
        function loadDashboardData() {
            fetch('/api/bi/executive_dashboard')
                .then(response => response.json())
                .then(data => {
                    dashboardData.executive = data;
                    loadExecutiveDashboard();
                })
                .catch(error => {
                    console.error('Error loading dashboard data:', error);
                });
        }

        // Load executive dashboard
        function loadExecutiveDashboard() {
            if (!dashboardData.executive) return;

            const data = dashboardData.executive;
            
            // Load executive KPIs
            const kpiContainer = document.getElementById('executive-kpis');
            const kpiHTML = data.kpis.slice(0, 4).map(kpi => `
                <div class="kpi-card">
                    <div class="kpi-change ${kpi.trend_direction === 'up' ? 'positive' : kpi.trend_direction === 'down' ? 'negative' : 'neutral'}">
                        ${kpi.change_percentage > 0 ? '+' : ''}${kpi.change_percentage.toFixed(1)}%
                    </div>
                    <div class="kpi-value">${formatValue(kpi.current_value, kpi.unit)}</div>
                    <div class="kpi-label">${kpi.metric_name}</div>
                    <div class="metric-trend">
                        <span class="trend-arrow trend-${kpi.trend_direction}">
                            ${kpi.trend_direction === 'up' ? '↗️' : kpi.trend_direction === 'down' ? '↘️' : '➡️'}
                        </span>
                        <small>vs. previous period</small>
                    </div>
                </div>
            `).join('');
            
            kpiContainer.innerHTML = kpiHTML;

            // Create revenue chart
            createRevenueChart();
            
            // Create customer chart
            createCustomerChart();
            
            // Create performance chart
            createPerformanceChart();

            // Load strategic insights
            loadStrategicInsights();
            
            // Load business recommendations
            loadBusinessRecommendations();
        }

        // Create revenue chart
        function createRevenueChart() {
            const ctx = document.getElementById('revenueChart').getContext('2d');
            
            if (charts.revenue) {
                charts.revenue.destroy();
            }

            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug'];
            const revenueData = [35000, 42000, 38000, 45000, 52000, 47000, 55000, 48000];

            charts.revenue = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Monthly Revenue',
                        data: revenueData,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000) + 'K';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Create customer chart
        function createCustomerChart() {
            const ctx = document.getElementById('customerChart').getContext('2d');
            
            if (charts.customer) {
                charts.customer.destroy();
            }

            charts.customer = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['New Customers', 'Returning', 'Churned'],
                    datasets: [{
                        label: 'Customer Metrics',
                        data: [245, 3102, 83],
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.8)',
                            'rgba(33, 150, 243, 0.8)',
                            'rgba(244, 67, 54, 0.8)'
                        ],
                        borderColor: [
                            'rgba(76, 175, 80, 1)',
                            'rgba(33, 150, 243, 1)',
                            'rgba(244, 67, 54, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Create performance chart
        function createPerformanceChart() {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            
            if (charts.performance) {
                charts.performance.destroy();
            }

            charts.performance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Conversion Rate', 'Engagement Rate', 'Retention Rate'],
                    datasets: [{
                        data: [3.47, 8.9, 85.2],
                        backgroundColor: [
                            'rgba(255, 193, 7, 0.8)',
                            'rgba(156, 39, 176, 0.8)',
                            'rgba(76, 175, 80, 0.8)'
                        ],
                        borderColor: [
                            'rgba(255, 193, 7, 1)',
                            'rgba(156, 39, 176, 1)',
                            'rgba(76, 175, 80, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Load KPI dashboard
        function loadKPIDashboard() {
            fetch('/api/bi/kpi_dashboard')
                .then(response => response.json())
                .then(data => {
                    const container = document.getElementById('kpi-metrics');
                    
                    let kpiHTML = '<div class="kpi-grid">';
                    
                    data.all_kpis.forEach(kpi => {
                        const progressPercent = (kpi.current_value / kpi.target_value) * 100;
                        
                        kpiHTML += `
                            <div class="kpi-card">
                                <div class="kpi-change ${kpi.trend_direction === 'up' ? 'positive' : kpi.trend_direction === 'down' ? 'negative' : 'neutral'}">
                                    ${kpi.change_percentage > 0 ? '+' : ''}${kpi.change_percentage.toFixed(1)}%
                                </div>
                                <div class="kpi-value">${formatValue(kpi.current_value, kpi.unit)}</div>
                                <div class="kpi-label">${kpi.metric_name}</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${Math.min(progressPercent, 100)}%"></div>
                                </div>
                                <small>Target: ${formatValue(kpi.target_value, kpi.unit)}</small>
                            </div>
                        `;
                    });
                    
                    kpiHTML += '</div>';
                    container.innerHTML = kpiHTML;
                })
                .catch(error => {
                    console.error('Error loading KPI data:', error);
                });
        }

        // Load reports dashboard
        function loadReportsDashboard() {
            // Load executive report
            fetch('/api/bi/generate_report/executive_summary')
                .then(response => response.json())
                .then(data => {
                    const container = document.getElementById('executive-report');
                    container.innerHTML = `
                        <div class="insights-container">
                            ${data.insights.map(insight => `
                                <div class="insight-item">
                                    <div class="insight-badge">Insight</div>
                                    ${insight}
                                </div>
                            `).join('')}
                        </div>
                    `;
                })
                .catch(error => console.error('Error loading executive report:', error));

            // Load other reports similarly...
        }

        // Load strategic insights
        function loadStrategicInsights() {
            const insights = [
                "Revenue growth of 18.5% exceeds industry average by 3.2%",
                "Customer acquisition cost decreased by 11.6%, improving unit economics",
                "Monthly Recurring Revenue reached $47,532.50",
                "Operational efficiency improved across all key metrics",
                "Net Promoter Score of 67 indicates strong customer satisfaction"
            ];

            const container = document.getElementById('strategic-insights');
            const insightsHTML = insights.map(insight => `
                <div class="insight-item">
                    <div class="insight-badge">AI</div>
                    ${insight}
                </div>
            `).join('');
            
            container.innerHTML = `<div class="insights-container">${insightsHTML}</div>`;
        }

        // Load business recommendations
        function loadBusinessRecommendations() {
            const recommendations = [
                { text: "Increase investment in top-performing marketing channels", priority: "high" },
                { text: "Implement customer success program to reduce churn", priority: "high" },
                { text: "Expand enterprise sales team to capture market opportunity", priority: "medium" },
                { text: "Develop upselling strategies for existing customer base", priority: "medium" },
                { text: "Optimize conversion funnel for better performance", priority: "low" }
            ];

            const container = document.getElementById('business-recommendations');
            const recsHTML = recommendations.map(rec => `
                <div class="recommendation-item">
                    <div class="recommendation-priority ${rec.priority}">${rec.priority.toUpperCase()}</div>
                    <div>${rec.text}</div>
                </div>
            `).join('');
            
            container.innerHTML = `<div class="recommendations-container">${recsHTML}</div>`;
        }

        // Utility functions
        function formatValue(value, unit) {
            if (unit === 'USD') {
                return '$' + value.toLocaleString();
            } else if (unit === '%') {
                return value.toFixed(1) + '%';
            } else if (unit === 'Users') {
                return value.toLocaleString();
            } else {
                return value.toLocaleString() + ' ' + unit;
            }
        }

        function exportData(format) {
            const url = `/api/bi/export/${format}`;
            window.open(url, '_blank');
        }

        function refreshData() {
            location.reload();
        }

        function refreshRealTimeData() {
            if (currentDashboard === 'executive') {
                loadDashboardData();
            } else if (currentDashboard === 'kpi') {
                loadKPIDashboard();
            }
        }

        // Additional analytics functions would be implemented here...
        function loadAnalyticsDashboard() {
            // Implementation for advanced analytics
        }

        function loadForecastingDashboard() {
            // Implementation for forecasting dashboard
        }
    </script>
</body>
</html>
